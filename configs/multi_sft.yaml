# Multi-SFT Recipe: collect N unique correct responses per prompt
# Early stop: when ≥ num_responses unique passed responses

data:
  input_path: ???                 # Path to input jsonl file
  preprocess:
    transform: null               # Data transform script (null = no transform)

work_dir: null                    # Output directory (null = auto timestamp)
verbose: false                    # Enable verbose logging

sampling:
  max_rollouts: 64                # Target: max valid rollouts to collect per prompt
  step_size: 8                    # Batch size: responses sampled per round
  max_steps: 8                    # Hard limit: max sampling rounds (max_steps × step_size should be ≥ max_rollouts to handle truncation)
  early_stop: true                # Stop when formatter is satisfied

sampler:
  type: openai-compatible-api     # Sampler type: openai-compatible-api | vllm-offline
  model: ???                      # Model name
  base_url: null                  # API endpoint (null = OpenAI default)
  api_key: null                   # API key (null = use env OPENAI_API_KEY)
  temperature: 0.8                # Sampling temperature (higher for diversity)
  max_tokens: 2048                # Max tokens per response
  top_p: 1.0                      # Nucleus sampling threshold
  concurrent_requests: 50         # Concurrent API requests
  timeout: 300                    # Request timeout in seconds
  drop_truncated: true            # Drop truncated responses
  extra_params: {}                # Extra API parameters

verifier:
  type: mcq-rlvr                  # Verifier type: mcq-rlvr | math-rlvr | mcq-llm-as-judge
  max_concurrent: 50              # Max concurrent requests (mcq-llm-as-judge only)

formatter:
  - type: multi_sft               # Formatter type
    num_responses: 32             # Required unique passed responses (must be ≤ max_rollouts)
    pass_threshold: 1.0           # Score >= this is passed
    fail_threshold: 0.0           # Score <= this is failed

shard:
  size: 10000                     # Items per shard file
